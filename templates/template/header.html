<nav id="navbar" class="fixed top-0 left-0 w-full text-gray-50 transition-all duration-300 z-50 
{{ 'bg-blue-950' if current_route in ['/learn-more', '/privacy-policy', '/how-to-use', '/faqs'] else '' }}">
    <div class="max-w-screen-xl flex items-center justify-between mx-auto p-2">
        <!--Logo-->
        <a href="/" class="flex items-center uppercase">
            <span class="self-center text-lg md:text-xl whitespace-nowrap font-normal">Rate<span
                    class="font-[1000]">Journee</span></span>
        </a>
        <!--Menu (Middle)-->
        <div class="hidden md:flex items-center flex-1 mx-10">
            <ul class="flex space-x-8">
                <li>
                    <a href="/#features" class="text-sm font-medium hover:text-blue-300 transition-colors">
                        {{_("Features")}}
                    </a>
                </li>
                <li>
                    <a href="/#about-us" class="text-sm font-medium hover:text-blue-300 transition-colors">
                        {{_("About Us")}}
                    </a>
                </li>
                <li>
                    <a href="/#support-us" class="text-sm font-medium hover:text-blue-300 transition-colors">
                        {{_("Support Us")}}
                    </a>
                </li>
            </ul>
        </div>
        <!--Right Section: Language Switcher & Get Started-->
        <div class="flex items-center space-x-4">
            <!-- Language switcher - Minimal dropdown style -->
            <div class="relative inline-block text-left group">
                <button id="language-menu-button" type="button"
                    class="flex items-center text-sm text-gray-200 hover:text-blue-300 transition-colors duration-200">
                    <span class="mr-1">{{ _("EN") if g.get("lang_code", "en") == "en" else _("ID") }}</span>
                    <svg id="languageDropdownIcon" class="w-3 h-3 transform transition-transform duration-200"
                        fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                    </svg>
                </button>

                <div id="language-menu"
                    class="hidden absolute right-0 z-50 mt-1 w-24 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black/5 focus:outline-none transition-all opacity-0 transition-opacity duration-200">
                    <div class="py-1">
                        {% if request.endpoint == 'home' %}
                        <a href="{{ url_for('home', lang='en') }}"
                            class="block px-3 py-1.5 text-sm text-gray-700 hover:bg-gray-200 transition-colors duration-150">English</a>
                        <a href="{{ url_for('home', lang='id') }}"
                            class="block px-3 py-1.5 text-sm text-gray-700 hover:bg-gray-200 transition-colors duration-150">Indonesia</a>
                        {% elif request.endpoint == 'how_to_use' %}
                        <a href="{{ url_for('how_to_use', lang='en') }}"
                            class="block px-3 py-1.5 text-sm text-gray-700 hover:bg-gray-200 transition-colors duration-150">English</a>
                        <a href="{{ url_for('how_to_use', lang='id') }}"
                            class="block px-3 py-1.5 text-sm text-gray-700 hover:bg-gray-200 transition-colors duration-150">Indonesia</a>
                        {% elif request.endpoint == 'privacy_policy' %}
                        <a href="{{ url_for('privacy_policy', lang='en') }}"
                            class="block px-3 py-1.5 text-sm text-gray-700 hover:bg-gray-200 transition-colors duration-150">English</a>
                        <a href="{{ url_for('privacy_policy', lang='id') }}"
                            class="block px-3 py-1.5 text-sm text-gray-700 hover:bg-gray-200 transition-colors duration-150">Indonesia</a>
                        {% elif request.endpoint == 'faqs' %}
                        <a href="{{ url_for('faqs', lang='en') }}"
                            class="block px-3 py-1.5 text-sm text-gray-700 hover:bg-gray-200 transition-colors duration-150">English</a>
                        <a href="{{ url_for('faqs', lang='id') }}"
                            class="block px-3 py-1.5 text-sm text-gray-700 hover:bg-gray-200 transition-colors duration-150">Indonesia</a>
                        {% elif request.endpoint == 'learn_more' %}
                        <a href="{{ url_for('learn_more', lang='en') }}"
                            class="block px-3 py-1.5 text-sm text-gray-700 hover:bg-gray-200 transition-colors duration-150">English</a>
                        <a href="{{ url_for('learn_more', lang='id') }}"
                            class="block px-3 py-1.5 text-sm text-gray-700 hover:bg-gray-200 transition-colors duration-150">Indonesia</a>
                        {% else %}
                        <a href="{{ url_for(request.endpoint, lang='en', **request.view_args) }}"
                            class="block px-3 py-1.5 text-sm text-gray-700 hover:bg-gray-200 transition-colors duration-150">English</a>
                        <a href="{{ url_for(request.endpoint, lang='id', **request.view_args) }}"
                            class="block px-3 py-1.5 text-sm text-gray-700 hover:bg-gray-200 transition-colors duration-150">Indonesia</a>
                        {% endif %}
                    </div>
                </div>
            </div>

            <!--Get Started Button-->
            <a href="/dashboard"
                class="bg-white text-sky-900 hover:bg-blue-100 px-4 py-2 rounded-md text-sm font-medium transition-colors">
                {{_("Get Started")}}
            </a>

            <!--Mobile Menu Button (visible only on mobile)-->
            <button id="menu-toggle" type="button" class="md:hidden text-gray-50 hover:text-blue-300">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                    xmlns="http://www.w3.org/2000/svg">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16">
                    </path>
                </svg>
            </button>
        </div>
    </div>

    <!--Mobile Menu (hidden by default)-->
    <div id="mobile-menu"
        class="hidden md:hidden transition-all duration-300 bg-blue-950/50 shadow-lg backdrop-blur-md">
        <div class="px-2 pt-2 pb-3 space-y-1">
            <a href="/#features"
                class="block px-3 py-2 text-sm font-medium hover:bg-sky-800 rounded-md menu-item">{{_("Features")}}</a>
            <a href="/#about-us"
                class="block px-3 py-2 text-sm font-medium hover:bg-sky-800 rounded-md menu-item">{{_("About Us")}}</a>
            <a href="/#support-us"
                class="block px-3 py-2 text-sm font-medium hover:bg-sky-800 rounded-md menu-item">{{_("Support
                Us")}}</a>
        </div>
    </div>
</nav>

<!-- Script untuk dropdown language switcher -->
<script>
    document.addEventListener('DOMContentLoaded', () => {
        const menuButton = document.getElementById('language-menu-button');
        const menu = document.getElementById('language-menu');
        const dropdownIcon = document.getElementById('languageDropdownIcon');

        // Toggle dropdown with animation
        menuButton.addEventListener('click', (e) => {
            e.stopPropagation();

            const isHidden = menu.classList.contains('hidden');

            if (isHidden) {
                menu.classList.remove('hidden');
                dropdownIcon.classList.add('rotate-180');

                setTimeout(() => {
                    menu.classList.remove('opacity-0');
                }, 10);
            } else {
                menu.classList.add('opacity-0');
                dropdownIcon.classList.remove('rotate-180');

                setTimeout(() => {
                    menu.classList.add('hidden');
                }, 200);
            }
        });

        // Close dropdown when clicking outside
        document.addEventListener('click', (event) => {
            if (!menuButton.contains(event.target) && !menu.contains(event.target)) {
                menu.classList.add('opacity-0');
                dropdownIcon.classList.remove('rotate-180');

                setTimeout(() => {
                    menu.classList.add('hidden');
                }, 200);
            }
        });
    });
</script>

<!--navbar-->
<script>
    let navbar = document.getElementById("navbar");
    let mobileMenu = document.getElementById("mobile-menu");
    let menuToggle = document.getElementById("menu-toggle");

    // Event untuk mendeteksi scroll
    window.addEventListener("scroll", function () {
        if (window.scrollY > 50) {
            navbar.classList.add("bg-blue-950/50", "shadow-lg", "backdrop-blur-md");
        } else {
            navbar.classList.remove("bg-blue-950/50", "shadow-lg");
        }
    });

    // Toggle Mobile Menu dengan gaya saat dibuka
    menuToggle.addEventListener("click", () => {
        mobileMenu.classList.toggle("hidden");

        // Pastikan menu selalu memiliki style saat dibuka
        if (!mobileMenu.classList.contains("hidden")) {
            mobileMenu.classList.add("bg-blue-950/50", "shadow-lg", "backdrop-blur-md");
        }
    });

    // Menutup menu setelah salah satu item diklik
    document.querySelectorAll(".menu-item").forEach(item => {
        item.addEventListener("click", () => {
            mobileMenu.classList.add("hidden");
        });
    });
</script>